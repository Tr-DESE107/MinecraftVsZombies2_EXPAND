#nullable enable // autogenerated

using System.Collections;
using MVZ2Logic;
using PVZEngine;
using UnityEngine;

namespace MVZ2.Vanilla
{
    public static class VanillaChapterTransitions
    {
        public readonly static NamespaceID halloween = Get("halloween");
        public readonly static NamespaceID dream = Get("dream");
        public readonly static NamespaceID castle = Get("castle");
        public readonly static NamespaceID mausoleum = Get("mausoleum");
        private static NamespaceID Get(string name)
        {
            return new NamespaceID(VanillaMod.spaceName, name);
        }
        public static IEnumerator TransitionToLevel(NamespaceID transition, NamespaceID areaID, NamespaceID stageID)
        {
            var music = Global.Music;
            var scene = Global.Scene;
            music.StartFade(0, 2);
            scene.SetScreenCoverColor(new Color(0, 0, 0, 0));
            scene.FadeScreenCoverColor(new Color(0, 0, 0, 1), 1);

            yield return new WaitForSeconds(2);

            yield return TransitionTalkToLevel(transition, areaID, stageID);
        }
        public static IEnumerator TransitionTalkToLevel(NamespaceID transition, NamespaceID areaID, NamespaceID stageID)
        {
            var music = Global.Music;
            var scene = Global.Scene;
            var level = Global.Level;
            music.Stop();
            scene.SetScreenCoverColor(new Color(0, 0, 0, 1));
            scene.FadeScreenCoverColor(new Color(0, 0, 0, 0), 0.5f);
            yield return scene.GotoChapterTransitionCoroutine(transition, false);

            scene.SetScreenCoverColor(new Color(0, 0, 0, 1));
            yield return scene.GotoLevelCoroutine();

            yield return new WaitForSeconds(2);

            scene.FadeScreenCoverColor(new Color(0, 0, 0, 0), 1);
            music.SetVolume(1);
            level.InitLevel(areaID, stageID, 1);
            scene.HideChapterTransition();
        }
        public static IEnumerator TransitionEndToMap(NamespaceID transition, NamespaceID mapID)
        {
            var music = Global.Music;
            var scene = Global.Scene;
            scene.SetScreenCoverColor(new Color(0, 0, 0, 1));
            scene.FadeScreenCoverColor(new Color(0, 0, 0, 0), 0.5f);
            yield return scene.GotoChapterTransitionCoroutine(transition, true);

            music.StartFade(0, 1);
            yield return new WaitForSeconds(2);
            music.SetVolume(1);
            scene.SetScreenCoverColor(new Color(0, 0, 0, 1));
            scene.FadeScreenCoverColor(new Color(0, 0, 0, 0), 1);
            scene.HideChapterTransition();
            scene.GotoMap(mapID);
        }
    }
}
