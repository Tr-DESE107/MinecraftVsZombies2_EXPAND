#nullable enable // autogenerated

using System.Linq;
using MVZ2.GameContent.Contraptions;
using MVZ2.GameContent.Seeds;
using MVZ2.Vanilla.Level;
using PVZEngine;
using PVZEngine.Definitions;
using PVZEngine.Level;
using UnityEngine;
using MVZ2.GameContent.Artifacts;
using MVZ2Logic.Level;

namespace MVZ2.GameContent.Stages
{
    [StageDefinition(VanillaStageNames.DowsingNote)]
    public partial class DowsingNote : StageDefinition
    {
        public DowsingNote(string nsp, string name) : base(nsp, name)
        {

            AddBehaviour(new WaveStageBehaviour(this));
            AddBehaviour(new FinalWaveClearBehaviour(this));
            AddBehaviour(new GemStageBehaviour(this));
            AddBehaviour(new StarshardStageBehaviour(this));
        }
        //public override void OnSetup(LevelEngine level)
        //{
        //    base.OnSetup(level);

        //    var grid = level.GetGrid(4, 2);
        //    var x = level.GetEntityColumnX(4);
        //    var z = level.GetEntityLaneZ(2);
        //    var y = level.GetGroundY(x, z);
        //    var position = new Vector3(x, y, z);
        //    level.Spawn(VanillaContraptionID.dispenser, position, null);
        //}
        //public override void OnSetup(LevelEngine level)
        //{
        //    base.OnSetup(level);
        //}

        public override void OnStart(LevelEngine level)
        {
            base.OnStart(level);

            level.SetSeedSlotCount(9);
            level.FillSeedPacks(new NamespaceID[]
            {
                VanillaBlueprintID.FromEntity(VanillaContraptionID.furnace),
                VanillaBlueprintID.FromEntity(VanillaContraptionID.gunpowderBarrel),
                VanillaBlueprintID.FromEntity(VanillaContraptionID.obsidian),
                VanillaBlueprintID.FromEntity(VanillaContraptionID.desirePot),
                VanillaBlueprintID.FromEntity(VanillaContraptionID.randomChina),
                VanillaBlueprintID.FromEntity(VanillaContraptionID.devourer),
                VanillaBlueprintID.FromEntity(VanillaContraptionID.mineTNT),
                VanillaBlueprintID.FromEntity(VanillaContraptionID.tnt),
                VanillaBlueprintID.FromEntity(VanillaContraptionID.woodenFan),
            });
            //level.SetPickaxeActive(false);
            level.SetArtifactSlotCount(3);
            level.ReplaceArtifacts(new NamespaceID[]
            {
                VanillaArtifactID.dowsingRods,
                VanillaArtifactID.dowsingRods,
                VanillaArtifactID.dowsingRods,
            });

        }

    }
}
