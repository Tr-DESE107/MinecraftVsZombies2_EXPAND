#nullable enable // autogenerated

using PVZEngine.Entities;

namespace MVZ2.Vanilla.Entities
{
    public abstract class StateMachineStatePool
    {
        public StateMachineStatePool()
        {
        }

        public int FindNextStateIndex(Entity entity, int currentIndex)
        {
            var states = GetStates();
            var length = states.Length;
            if (length <= 0)
                return -1;
            if (currentIndex < 0)
            {
                currentIndex = 0;
            }
            for (int i = 0; i < length; i++)
            {
                var index = (currentIndex + i) % length;
                var state = states[index];
                if (!CanStartState(entity, state))
                    continue;
                return index;
            }
            return -1;
        }
        public int GetState(int currentIndex)
        {
            var states = GetStates();
            if (currentIndex < 0 || currentIndex >= states.Length)
            {
                return 0;
            }
            return states[currentIndex];
        }
        protected abstract int[] GetStates();
        protected virtual bool CanStartState(Entity entity, int state)
        {
            return true;
        }
    }
}
