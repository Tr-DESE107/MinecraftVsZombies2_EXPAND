#nullable enable // autogenerated

using PVZEngine.Buffs;

namespace PVZEngine.Armors
{
    public partial class Armor
    {
        private void UpdateBuffs()
        {
            buffs.Update();
        }

        #region 事件回调
        private void OnBuffedPropertyChangedCallback(IPropertyKey name)
        {
            properties.UpdateModifiedProperty(name);
        }
        #endregion

        #region 增益
        public BuffReference GetBuffReference(Buff buff) => new BuffReferenceArmor(Owner.ID, Slot, buff.ID);
        private void InitBuffEvents()
        {
            buffs.OnPropertyChanged += OnBuffedPropertyChangedCallback;
        }
        #endregion

        private void WriteBuffsToSerializable(SerializableArmor seri)
        {
            seri.buffs = buffs.ToSerializable();
        }
        private void InitBuffsFromSerializable(SerializableArmor seri)
        {
            buffs = BuffList.CreateFromSerializable(seri.buffs, Owner.Level, Owner);
            InitBuffEvents();
        }
        private void LoadBuffsFromSerializable(SerializableArmor seri)
        {
            if (seri.buffs != null)
                buffs.LoadFromSerializable(seri.buffs);
        }
        #region 属性字段
        IBuffList IBuffTarget.Buffs => buffs;
        private BuffList buffs = new BuffList();
        #endregion
    }
}