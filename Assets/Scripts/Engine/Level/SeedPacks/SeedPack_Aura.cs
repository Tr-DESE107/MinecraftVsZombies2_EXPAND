#nullable enable // autogenerated

using System.Linq;
using PVZEngine.Auras;

namespace PVZEngine.SeedPacks
{
    public partial class SeedPack
    {
        private void CreateAuraEffects()
        {
            var auraCount = Definition.GetAuraCount();
            for (int i = 0; i < auraCount; i++)
            {
                var auraDef = Definition.GetAuraAt(i);
                auras.Add(Level, new AuraEffect(auraDef, i, this));
            }
        }
        private void UpdateAuras()
        {
            auras.Update();
        }

        #region 获取
        public AuraEffect GetAuraEffect<T>() where T : AuraEffectDefinition
        {
            return auras.Get<T>();
        }
        public AuraEffect[] GetAuraEffects()
        {
            return auras.GetAll();
        }
        #endregion

        #region 序列化
        protected void SaveAurasToSerializable(SerializableSeedPack seri)
        {
            seri.auras = auras.GetAll().Select(a => a.ToSerializable()).ToArray();
        }
        private void LoadAurasFromSerializable(SerializableSeedPack seri)
        {
            if (seri.auras == null)
                return;
            auras.LoadFromSerializable(Level, seri.auras);
        }
        #endregion

        #region 属性字段
        protected AuraEffectList auras = new AuraEffectList();
        #endregion
    }
}
