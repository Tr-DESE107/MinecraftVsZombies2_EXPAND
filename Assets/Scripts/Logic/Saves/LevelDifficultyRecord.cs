#nullable enable // autogenerated

using System;
using System.Collections.Generic;
using System.Linq;
using PVZEngine;
using PVZEngine.Base;

namespace MVZ2Logic.Saves
{
    public class LevelDifficultyRecord
    {
        public LevelDifficultyRecord(string id)
        {
            ID = id;
        }
        public void AddRecord(NamespaceID difficulty)
        {
            difficulties.Add(difficulty);
        }
        public bool RemoveRecord(NamespaceID difficulty)
        {
            return difficulties.Remove(difficulty);
        }
        public bool HasRecord(NamespaceID difficulty)
        {
            return difficulties.Contains(difficulty);
        }
        public NamespaceID[] GetAllRecords()
        {
            return difficulties.ToArray();
        }
        public SerializableLevelDifficultyRecord ToSerializable()
        {
            return new SerializableLevelDifficultyRecord()
            {
                id = ID,
                difficulties = difficulties.ToArray(),
            };
        }
        public static LevelDifficultyRecord? FromSerializable(SerializableLevelDifficultyRecord serializable)
        {
            if (string.IsNullOrEmpty(serializable.id))
            {
                Log.LogException(MissingSerializeDataException.Property<LevelDifficultyRecord>(nameof(ID)));
                return null;
            }
            var difficulties = new HashSet<NamespaceID>();
            if (serializable.difficulties != null)
            {
                foreach (var diff in serializable.difficulties)
                {
                    if (diff == null)
                        continue;
                    difficulties.Add(diff);
                }
            }
            return new LevelDifficultyRecord(serializable.id)
            {
                difficulties = difficulties
            };
        }
        public string ID { get; private set; }
        private HashSet<NamespaceID> difficulties = new HashSet<NamespaceID>();
    }
    [Serializable]
    public class SerializableLevelDifficultyRecord
    {
        public string? id;
        public NamespaceID?[]? difficulties;
    }
}
