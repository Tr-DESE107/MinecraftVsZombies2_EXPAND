#nullable enable // autogenerated

using System.Collections.Generic;
using System.Xml;
using MVZ2.IO;
using PVZEngine;

namespace MVZ2.Metas
{
    public class StoreChatGroupMeta
    {
        public StoreChatGroupMeta(NamespaceID character, StoreChatMeta[] chats)
        {
            Character = character;
            Chats = chats;
        }

        public NamespaceID Character { get; private set; }
        public StoreChatMeta[] Chats { get; private set; }
        public static StoreChatGroupMeta? FromXmlNode(XmlNode node, string defaultNsp)
        {
            var character = node.GetAttributeNamespaceID("character", defaultNsp);
            if (!NamespaceID.IsValid(character))
            {
                Log.LogError($"The {nameof(character)} of a {nameof(StoreChatGroupMeta)} is invalid.");
                return null;
            }

            List<StoreChatMeta> chats = new List<StoreChatMeta>();
            for (int i = 0; i < node.ChildNodes.Count; i++)
            {
                var childNode = node.ChildNodes[i];
                if (childNode.Name == "chat")
                {
                    chats.Add(StoreChatMeta.FromXmlNode(childNode, defaultNsp));
                }
            }
            return new StoreChatGroupMeta(character, chats.ToArray());
        }
    }
}
