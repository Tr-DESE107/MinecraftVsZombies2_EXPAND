#nullable enable // autogenerated

using System.Linq;
using System.Xml;
using MVZ2.IO;
using MVZ2Logic.Conditions;
using MVZ2Logic.Games;
using PVZEngine;

namespace MVZ2.Metas
{
    public class XMLCondition : ICondition
    {
        public static XMLCondition FromXmlNode(XmlNode node, string defaultNsp)
        {
            var required = node.GetAttributeNamespaceIDArray("required", defaultNsp);
            var requiredNot = node.GetAttributeNamespaceIDArray("requiredNot", defaultNsp);
            return new XMLCondition()
            {
                Required = required,
                RequiredNot = requiredNot
            };
        }
        public bool MeetsCondition(IGlobalSaveData save)
        {
            if (Required != null && Required.Any(c => !save.IsUnlocked(c)))
                return false;
            if (RequiredNot != null && RequiredNot.Any(c => save.IsUnlocked(c)))
                return false;
            return true;
        }
        public NamespaceID[]? Required { get; set; }
        public NamespaceID[]? RequiredNot { get; set; }
    }
}
