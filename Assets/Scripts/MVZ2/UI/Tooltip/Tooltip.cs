#nullable enable // autogenerated

using System.Collections.Generic;
using TMPro;
using UnityEngine;
using UnityEngine.UI;

namespace MVZ2.UI
{
    public class Tooltip : MonoBehaviour
    {
        public void Show()
        {
            gameObject.SetActive(true);
        }
        public void Hide()
        {
            gameObject.SetActive(false);
        }
        public void SetPosition(TooltipPosition viewData)
        {
            var rectTransform = transform as RectTransform;
            if (rectTransform.Exists())
            {
                rectTransform.pivot = viewData.pivot;
                rectTransform.position = viewData.position;
                var rootCanvas = rectTransform.GetRootCanvasNonAlloc(canvasListCache);
                if (rootCanvas.Exists() && rootCanvas.transform is RectTransform rectTrans)
                {
                    rectTransform.LimitInsideScreen(rectTrans, rootTransform.rect.size);
                }
            }
        }
        public void SetContent(TooltipContent content)
        {
            nameText.text = content.name;
            errorText.text = content.error;
            descriptionText.text = content.description;
            nameText.gameObject.SetActive(!string.IsNullOrEmpty(content.name));
            errorText.gameObject.SetActive(!string.IsNullOrEmpty(content.error));
            descriptionText.gameObject.SetActive(!string.IsNullOrEmpty(content.description));
            ForceRebuildLayout();
        }
        public void ForceRebuildLayout()
        {
            var rectTransform = transform as RectTransform;
            LayoutRebuilder.ForceRebuildLayoutImmediate(rectTransform);
        }
        [SerializeField]
        RectTransform rootTransform = null!;
        [SerializeField]
        TextMeshProUGUI nameText = null!;
        [SerializeField]
        TextMeshProUGUI errorText = null!;
        [SerializeField]
        TextMeshProUGUI descriptionText = null!;
        private List<Canvas> canvasListCache = new List<Canvas>();
    }
    public struct TooltipPosition
    {
        public Vector2 pivot;
        public Vector2 position;
    }
    public struct TooltipContent
    {
        public Vector2 pivot;
        public Vector2 position;
        public string name;
        public string? error;
        public string? description;
    }
}
