#nullable enable // autogenerated

using System;
using System.Linq;
using MukioI18n;
using MVZ2.Cameras;
using MVZ2.Managers;
using MVZ2.UI;
using MVZ2.Vanilla;
using MVZ2.Vanilla.Saves;
using MVZ2Logic;
using MVZ2Logic.Games;
using PVZEngine;
using UnityEngine;

namespace MVZ2.Options
{
    using static MVZ2.UI.OptionsDialog;

    public abstract class OptionsLogic : IDisposable
    {
        public OptionsLogic(OptionsDialog dialog)
        {
            ResolutionManager.OnResolutionChanged += OnResolutionChangedCallback;

            this.dialog = dialog;

            dialog.OnButtonClick += OnButtonClickCallback;
            dialog.OnToggleValueChanged += OnToggleValueChangedCallback;
            dialog.OnSliderValueChanged += OnSliderValueChangedCallback;
            dialog.OnDropdownValueChanged += OnDropdownValueChangedCallback;
            dialog.OnTooltipShow += OnTooltipShowCallback;
            dialog.OnTooltipHide += OnTooltipHideCallback;

            Language = Main.OptionsManager.GetLanguage();
            BloodAndGore = Main.OptionsManager.HasBloodAndGore();
        }
        public virtual void InitDialog()
        {
            // Main
            UpdateMusicSlider();
            UpdateSoundSlider();
            UpdateFastforwardSlider();
            UpdateSwapTriggerToggle();
            UpdatePauseOnFocusLostToggle();
            UpdateDifficultyButton();

            // More
            // General
            InitLanguageDropdown();
            UpdateLanguageDropdown();
            UpdateVibrationToggle();
            UpdateSkipAllTalksToggle();
            UpdateChooseWarningsToggle();
            UpdateCommandBlockModeButton();

            // Display
            UpdateFullscreenToggle(Main.OptionsManager.IsFullscreen());
            UpdateAnimationFrequencySlider();
            InitResolutionDropdown();
            UpdateResolutionDropdown();
            UpdateParticlesSlider();
            UpdateShakeSlider();
            UpdateBloodAndGoreToggle();
            UpdateShowFPSButton();
            UpdateHeightIndicatorToggle();
            UpdateHDRLightingToggle();

            // Controls
            UpdateShowHotkeysToggle();

            // Misc
            UpdateShowSponsorNamesToggle();

            bool mobile = Main.IsMobile();
            dialog.SetToggleActive(ToggleType.SwapTrigger, Main.SaveManager.IsTriggerUnlocked());
            dialog.SetToggleActive(ToggleType.Vibration, mobile);
            dialog.SetToggleActive(ToggleType.Fullscreen, !mobile);
            dialog.SetToggleActive(ToggleType.ShowHotkeys, !mobile);

            dialog.SetButtonActive(ButtonType.CommandBlockMode, Main.SaveManager.IsCommandBlockUnlocked());

            dialog.SetButtonActive(ButtonType.Keybinding, !mobile);
            dialog.SetDropdownActive(DropdownType.Resolution, !mobile);

            dialog.SetPage(Page.Main);
        }
        public virtual void Dispose()
        {
            if (NeedsReload)
            {
                Main.OptionsManager.SetLanguage(Language);
                Main.OptionsManager.SetBloodAndGore(BloodAndGore);
            }
            dialog.OnButtonClick -= OnButtonClickCallback;
            dialog.OnToggleValueChanged -= OnToggleValueChangedCallback;
            dialog.OnSliderValueChanged -= OnSliderValueChangedCallback;
            dialog.OnDropdownValueChanged -= OnDropdownValueChangedCallback;
            dialog.OnTooltipShow -= OnTooltipShowCallback;
            dialog.OnTooltipHide -= OnTooltipHideCallback;
            ResolutionManager.OnResolutionChanged -= OnResolutionChangedCallback;
        }
        protected virtual void OnButtonClickCallback(ButtonType type)
        {
            switch (type)
            {
                case ButtonType.Back:
                    OnClose?.Invoke();
                    break;
                case ButtonType.Difficulty:
                    {
                        Main.OptionsManager.CycleDifficulty();
                        UpdateDifficultyButton();
                    }
                    break;
                case ButtonType.MoreOptions:
                    dialog.SetPage(Page.More);
                    break;
                case ButtonType.MoreBack:
                    dialog.SetPage(Page.Main);
                    break;

                // General.
                case ButtonType.CommandBlockMode:
                    {
                        Main.OptionsManager.CycleCommandBlockMode();
                        UpdateCommandBlockModeButton();
                    }
                    break;

                // Display.
                case ButtonType.ShowFPS:
                    {
                        Main.OptionsManager.CycleFPSMode();
                        UpdateShowFPSButton();
                    }
                    break;

                // Controls.
                case ButtonType.Keybinding:
                    {
                        Main.Scene.ShowKeybinding();
                    }
                    break;

                // Misc.
                case ButtonType.Credits:
                    {
                        Main.Scene.ShowCredits();
                    }
                    break;
                case ButtonType.ExportLogFiles:
                    {
                        Main.DebugManager.ExportLogFiles();
                    }
                    break;
            }
        }
        protected virtual void OnToggleValueChangedCallback(ToggleType type, bool value)
        {

            switch (type)
            {
                case ToggleType.SwapTrigger:
                    {
                        Main.OptionsManager.SwitchSwapTrigger();
                        UpdateSwapTriggerToggle();
                    }
                    break;
                case ToggleType.PauseOnFocusLost:
                    {
                        Main.OptionsManager.SwitchPauseOnFocusLost();
                        UpdatePauseOnFocusLostToggle();
                    }
                    break;

                // General.
                case ToggleType.Vibration:
                    {
                        Main.OptionsManager.SwitchVibration();
                        UpdateVibrationToggle();
                    }
                    break;
                case ToggleType.SkipAllTalks:
                    {
                        Main.OptionsManager.SwitchSkipAllTalks();
                        UpdateSkipAllTalksToggle();
                    }
                    break;
                case ToggleType.ChooseWarnings:
                    {
                        Main.OptionsManager.SwitchBlueprintChooseWarningsDisabled();
                        UpdateChooseWarningsToggle();
                    }
                    break;

                // Display.
                case ToggleType.Fullscreen:
                    {
                        bool fullscreen = Main.OptionsManager.IsFullscreen();
                        Main.OptionsManager.SetFullscreen(!fullscreen);
                        UpdateFullscreenToggle(!fullscreen);
                    }
                    break;
                case ToggleType.BloodAndGore:
                    {
                        BloodAndGore = !BloodAndGore;
                        NeedsReload = true;
                        UpdateBloodAndGoreToggle();
                    }
                    break;
                case ToggleType.HeightIndicator:
                    {
                        Main.OptionsManager.SwitchHeightIndicatorEnabled();
                        UpdateHeightIndicatorToggle();
                    }
                    break;
                case ToggleType.HDRLighting:
                    {
                        Main.OptionsManager.SwitchHDRLightingDisabled();
                        UpdateHDRLightingToggle();
                    }
                    break;

                // Controls.
                case ToggleType.ShowHotkeys:
                    {
                        Main.OptionsManager.SwitchShowHotkeyIndicators();
                        UpdateShowHotkeysToggle();
                    }
                    break;

                // Misc.
                case ToggleType.ShowSponsorNames:
                    {
                        Main.OptionsManager.SwitchShowSponsorNames();
                        UpdateShowSponsorNamesToggle();
                    }
                    break;
            }
        }
        protected virtual void OnSliderValueChangedCallback(SliderType type, float value)
        {
            switch (type)
            {
                case SliderType.Music:
                    {
                        Main.OptionsManager.SetMusicVolume(value);
                        UpdateMusicSlider();
                    }
                    break;
                case SliderType.Sound:
                    {
                        Main.OptionsManager.SetSoundVolume(value);
                        UpdateSoundSlider();
                    }
                    break;
                case SliderType.FastForward:
                    {
                        var multi = ValueToFastForwardMultiplier(value);
                        Main.OptionsManager.SetFastForwardMultiplier(multi);
                        UpdateFastforwardSlider();
                    }
                    break;
                case SliderType.AnimationFrequency:
                    {
                        var multi = ValueToAnimationFrequency(value);
                        Main.OptionsManager.SetAnimationFrequency(multi);
                        UpdateAnimationFrequencySlider();
                    }
                    break;
                case SliderType.Particles:
                    {
                        Main.OptionsManager.SetParticleAmount(value);
                        UpdateParticlesSlider();
                    }
                    break;
                case SliderType.Shake:
                    {
                        Main.OptionsManager.SetShakeAmount(value);
                        UpdateShakeSlider();
                    }
                    break;
            }
        }
        protected virtual void OnDropdownValueChangedCallback(DropdownType type, int index)
        {
            switch (type)
            {
                case DropdownType.Language:
                    {
                        Language = languageValues[index];
                        NeedsReload = true;
                        UpdateLanguageDropdown();
                    }
                    break;
                case DropdownType.Resolution:
                    {
                        var resolution = resolutionValues[index];
                        Main.ResolutionManager.SetResolution(resolution.x, resolution.y);
                        UpdateResolutionDropdown();
                    }
                    break;
            }
        }
        private void OnResolutionChangedCallback(int width, int height)
        {
            InitResolutionDropdown();
            UpdateResolutionDropdown();
        }
        private void OnTooltipShowCallback(TooltipHandler handler)
        {
            if (string.IsNullOrEmpty(handler.text))
                return;
            string text;
            if (string.IsNullOrEmpty(handler.context))
            {
                text = Main.LanguageManager._(handler.text);
            }
            else
            {
                text = Main.LanguageManager._p(handler.context, handler.text);
            }
            var camera = dialog.GetCamera();
            if (!camera.Exists())
                return;
            Main.Scene.ShowTooltip(new SimpleTooltipSource(camera, handler, new TooltipContent() { description = text }));
        }
        private void OnTooltipHideCallback(TooltipHandler handler)
        {
            Main.Scene.HideTooltip();
        }

        #region 更新元素
        protected string GetValueText(bool value)
        {
            return Main.LanguageManager._(value ? VanillaStrings.YES : VanillaStrings.NO);
        }
        protected string GetValueTextOnOff(bool value)
        {
            return Main.LanguageManager._(value ? VanillaStrings.ON : VanillaStrings.OFF);
        }
        protected string GetValueTextCommandBlockMode(int value)
        {
            switch (value)
            {
                case CommandBlockModes.PREVIOUS:
                    return Main.LanguageManager._p(VanillaStrings.CONTEXT_COMMAND_BLOCK_MODE, COMMAND_BLOCK_MODE_PREVIOUS);
            }
            return Main.LanguageManager._p(VanillaStrings.CONTEXT_COMMAND_BLOCK_MODE, COMMAND_BLOCK_MODE_MANUAL);
        }
        protected string GetValueTextFPSMode(int value)
        {
            var key = FPS_MODE_DISABLED;
            switch (value)
            {
                case FPSModes.TOP_LEFT:
                    key = FPS_MODE_TOP_LEFT;
                    break;
                case FPSModes.TOP_RIGHT:
                    key = FPS_MODE_TOP_RIGHT;
                    break;
                case FPSModes.BOTTOM_LEFT:
                    key = FPS_MODE_BOTTOM_LEFT;
                    break;
                case FPSModes.BOTTOM_RIGHT:
                    key = FPS_MODE_BOTTOM_RIGHT;
                    break;
            }
            return Main.LanguageManager._p(VanillaStrings.CONTEXT_FPS_MODE, key);
        }
        protected string GetDifficultyText(NamespaceID id)
        {
            return Main.Game.GetDifficultyName(id);
        }
        protected void UpdateSliderValue(float value, string optionKey, SliderType sliderType)
        {
            var valueText = Main.GetFloatPercentageText(value);
            var text = Main.LanguageManager._(optionKey, valueText);
            dialog.SetSliderValue(sliderType, value);
            dialog.SetSliderText(sliderType, text);
        }
        protected void UpdateButtonText(bool value, string optionKey, TextButtonType buttonType)
        {
            var valueText = GetValueText(value);
            var text = Main.LanguageManager._(optionKey, valueText);
            dialog.SetButtonText(buttonType, text);
        }
        protected void UpdateToggle(bool value, string optionKey, ToggleType toggleType)
        {
            var text = Main.LanguageManager._(optionKey);
            dialog.SetToggleText(toggleType, text);
            dialog.SetToggleOn(toggleType, value);
        }

        #region 主界面
        protected void UpdateMusicSlider()
        {
            var value = Main.OptionsManager.GetMusicVolume();
            UpdateSliderValue(value, OPTION_MUSIC, SliderType.Music);
        }
        protected void UpdateSoundSlider()
        {
            var value = Main.OptionsManager.GetSoundVolume();
            UpdateSliderValue(value, OPTION_SOUND, SliderType.Sound);
        }
        protected void UpdateFastforwardSlider()
        {
            var multi = Main.OptionsManager.GetFastForwardMultiplier();
            var value = FastForwardMultiplierToValue(multi);

            var valueText = Main.GetFloatPercentageText(multi);
            var text = Main.LanguageManager._(OPTION_FASTFORWARD_MULTIPLIER, valueText);
            dialog.SetSliderRange(SliderType.FastForward, FASTFORWARD_SLIDER_START, FASTFORWARD_SLIDER_END, true);
            dialog.SetSliderValue(SliderType.FastForward, value);
            dialog.SetSliderText(SliderType.FastForward, text);
        }
        protected void UpdateAnimationFrequencySlider()
        {
            var multi = Main.OptionsManager.GetAnimationFrequency();
            var value = AnimationFrequencyToValue(multi);

            var valueText = Main.GetFloatPercentageText(multi);
            var text = Main.LanguageManager._(OPTION_ANIMATION_FREQUENCY, valueText);
            dialog.SetSliderRange(SliderType.AnimationFrequency, ANIMATION_FREQUENCY_SLIDER_START, ANIMATION_FREQUENCY_SLIDER_END, false);
            dialog.SetSliderValue(SliderType.AnimationFrequency, value);
            dialog.SetSliderText(SliderType.AnimationFrequency, text);
        }
        protected float ValueToFastForwardMultiplier(float value)
        {
            return FASTFORWARD_MULTIPLIER_START + FASTFORWARD_STEP * value;
        }
        protected float FastForwardMultiplierToValue(float multi)
        {
            return Mathf.RoundToInt((multi - FASTFORWARD_MULTIPLIER_START) / FASTFORWARD_STEP);
        }
        private float ValueToAnimationFrequency(float value)
        {
            return value;
        }
        protected float AnimationFrequencyToValue(float frequency)
        {
            return frequency;
        }
        protected void UpdateSwapTriggerToggle()
        {
            var value = Main.OptionsManager.IsTriggerSwapped();
            UpdateToggle(value, OPTION_SWAP_TRIGGER, ToggleType.SwapTrigger);
        }
        private void UpdatePauseOnFocusLostToggle()
        {
            var value = Main.OptionsManager.GetPauseOnFocusLost();
            UpdateToggle(value, OPTION_PAUSE_ON_FOCUS_LOST, ToggleType.PauseOnFocusLost);
        }
        protected void UpdateDifficultyButton()
        {
            var value = Main.OptionsManager.GetDifficulty();
            var valueText = GetDifficultyText(value);
            var text = Main.LanguageManager._(OPTION_DIFFICULTY, valueText);
            dialog.SetButtonText(TextButtonType.Difficulty, text);
        }
        #endregion

        #region 常规设置
        private void InitLanguageDropdown()
        {
            var values = Main.LanguageManager.GetAllLanguages();
            languageValues = values;
            dialog.SetDropdownValues(DropdownType.Language, values.Select(v => Main.LanguageManager.GetLanguageName(v)).ToArray());
        }
        private void UpdateLanguageDropdown()
        {
            var value = Language;
            var index = Array.IndexOf(languageValues, value);
            dialog.SetDropdownValue(DropdownType.Language, index);
        }
        protected void UpdateVibrationToggle()
        {
            var value = Main.OptionsManager.IsVibration();
            UpdateToggle(value, OPTION_VIBRATION, ToggleType.Vibration);
        }
        protected void UpdateSkipAllTalksToggle()
        {
            var value = Main.OptionsManager.SkipAllTalks();
            UpdateToggle(value, OPTION_SKIP_ALL_TALKS, ToggleType.SkipAllTalks);
        }
        protected void UpdateChooseWarningsToggle()
        {
            var value = !Main.OptionsManager.AreBlueprintChooseWarningsDisabled();
            UpdateToggle(value, OPTION_CHOOSE_WARNINGS, ToggleType.ChooseWarnings);
        }
        protected void UpdateCommandBlockModeButton()
        {
            var value = Main.OptionsManager.GetCommandBlockMode();
            var valueText = GetValueTextCommandBlockMode(value);
            var text = Main.LanguageManager._(OPTION_COMMAND_BLOCK_MODE, valueText);
            dialog.SetButtonText(TextButtonType.CommandBlockMode, text);
        }
        #endregion

        #region 显示设置
        private void InitResolutionDropdown()
        {
            var resolutions = Main.ResolutionManager.GetResolutions().Select(r => new Vector2Int(r.width, r.height)).Distinct().ToArray();
            var currentResolution = Main.ResolutionManager.GetCurrentResolution();
            Vector2Int[] values;
            if (!resolutions.Any(r => r.x == currentResolution.width && r.y == currentResolution.height))
            {
                values = new Vector2Int[resolutions.Length + 1];
                for (int i = 0; i < resolutions.Length; i++)
                {
                    values[i] = resolutions[i];
                }
                values[values.Length - 1] = new Vector2Int(currentResolution.width, currentResolution.height);
            }
            else
            {
                values = resolutions;
            }
            resolutionValues = values;

            var texts = values.Select(v => Main.ResolutionManager.GetResolutionName(v.x, v.y));
            dialog.SetDropdownValues(DropdownType.Resolution, texts.ToArray());
        }
        private void UpdateResolutionDropdown()
        {
            var value = Main.ResolutionManager.GetCurrentResolution();
            var index = Array.FindIndex(resolutionValues, r => r.x == value.width && r.y == value.height);
            if (index < 0)
            {
                index = resolutionValues.Length - 1;
            }
            dialog.SetDropdownValue(DropdownType.Resolution, index);
        }
        protected void UpdateFullscreenToggle(bool value)
        {
            UpdateToggle(value, OPTION_FULLSCREEN, ToggleType.Fullscreen);
        }
        private void UpdateParticlesSlider()
        {
            var value = Main.OptionsManager.GetParticleAmount();
            UpdateSliderValue(value, OPTION_PARTICLE_AMOUNT, SliderType.Particles);
        }
        private void UpdateShakeSlider()
        {
            var value = Main.OptionsManager.GetShakeAmount();
            UpdateSliderValue(value, OPTION_SHAKE_AMOUNT, SliderType.Shake);
        }
        protected void UpdateShowFPSButton()
        {
            var value = Main.OptionsManager.GetFPSMode();
            var valueText = GetValueTextFPSMode(value);
            var text = Main.LanguageManager._(OPTION_FPS_MODE, valueText);
            dialog.SetButtonText(TextButtonType.ShowFPS, text);
        }
        protected void UpdateHeightIndicatorToggle()
        {
            var value = Main.OptionsManager.IsHeightIndicatorEnabled();
            UpdateToggle(value, OPTION_HEIGHT_INDICATOR, ToggleType.HeightIndicator);
        }
        protected void UpdateHDRLightingToggle()
        {
            var value = !Main.OptionsManager.HDRLightingDisabled();
            UpdateToggle(value, OPTION_HDR_LIGHTING, ToggleType.HDRLighting);
        }
        private void UpdateBloodAndGoreToggle()
        {
            var value = BloodAndGore;
            UpdateToggle(value, OPTION_BLOOD_AND_GORE, ToggleType.BloodAndGore);
        }
        #endregion

        #region 控制
        protected void UpdateShowHotkeysToggle()
        {
            var value = Main.OptionsManager.ShowHotkeyIndicators();
            UpdateToggle(value, OPTION_SHOW_HOTKEYS, ToggleType.ShowHotkeys);
        }
        #endregion

        #region 杂项
        protected void UpdateShowSponsorNamesToggle()
        {
            var value = Main.OptionsManager.ShowSponsorNames();
            UpdateToggle(value, OPTION_SHOW_SPONSOR_NAMES, ToggleType.ShowSponsorNames);
        }
        #endregion

        #endregion

        public event Action? OnClose;

        public const int FASTFORWARD_STEP_COUNT = 20;
        public const float FASTFORWARD_SLIDER_START = 0;
        public const float FASTFORWARD_SLIDER_END = FASTFORWARD_STEP_COUNT;
        public const float FASTFORWARD_MULTIPLIER_START = 0;
        public const float FASTFORWARD_MULTIPLIER_END = 4;
        public const float FASTFORWARD_MULTIPLIER_RANGE = FASTFORWARD_MULTIPLIER_END - FASTFORWARD_MULTIPLIER_START;
        public const float FASTFORWARD_STEP = FASTFORWARD_MULTIPLIER_RANGE / FASTFORWARD_STEP_COUNT;

        public const float ANIMATION_FREQUENCY_SLIDER_START = 0.3f;
        public const float ANIMATION_FREQUENCY_SLIDER_END = 1;
        public const float ANIMATION_FREQUENCY_START = 0.3f;
        public const float ANIMATION_FREQUENCY_END = 1;


        [TranslateMsg("选项")]
        public const string OPTION_SWAP_TRIGGER = "交换触发";
        [TranslateMsg("选项")]
        public const string OPTION_FULLSCREEN = "全屏";
        [TranslateMsg("选项")]
        public const string OPTION_VIBRATION = "设备震动";
        [TranslateMsg("选项")]
        public const string OPTION_PAUSE_ON_FOCUS_LOST = "后台暂停";
        [TranslateMsg("选项，{0}为难度")]
        public const string OPTION_DIFFICULTY = "难度：{0}";


        [TranslateMsg("选项，{0}为量")]
        public const string OPTION_MUSIC = "音乐音量：{0}";
        [TranslateMsg("选项，{0}为量")]
        public const string OPTION_SOUND = "音效音量：{0}";
        [TranslateMsg("选项，{0}为量")]
        public const string OPTION_FASTFORWARD_MULTIPLIER = "加速倍率：{0}";
        [TranslateMsg("选项，{0}为量")]
        public const string OPTION_ANIMATION_FREQUENCY = "动画频率：{0}";
        [TranslateMsg("选项")]
        public const string OPTION_HDR_LIGHTING = "HDR光照";

        [TranslateMsg("选项")]
        public const string OPTION_BLOOD_AND_GORE = "血与碎块";

        [TranslateMsg("选项")]
        public const string OPTION_SKIP_ALL_TALKS = "跳过对话";
        [TranslateMsg("选项")]
        public const string OPTION_SHOW_SPONSOR_NAMES = "赞助者名称";
        [TranslateMsg("选项")]
        public const string OPTION_CHOOSE_WARNINGS = "选卡警告";
        [TranslateMsg("选项，{0}为模式")]
        public const string OPTION_COMMAND_BLOCK_MODE = "命令方块：{0}";
        [TranslateMsg("选项，{0}为模式")]
        public const string OPTION_FPS_MODE = "显示帧率：{0}";
        [TranslateMsg("选项")]
        public const string OPTION_HEIGHT_INDICATOR = "高度指示器";
        [TranslateMsg("选项")]
        public const string OPTION_SHOW_HOTKEYS = "显示快捷键";

        [TranslateMsg("命令方块模式", VanillaStrings.CONTEXT_COMMAND_BLOCK_MODE)]
        public const string COMMAND_BLOCK_MODE_MANUAL = "手选";
        [TranslateMsg("命令方块模式", VanillaStrings.CONTEXT_COMMAND_BLOCK_MODE)]
        public const string COMMAND_BLOCK_MODE_PREVIOUS = "前位";

        [TranslateMsg("FPS模式", VanillaStrings.CONTEXT_FPS_MODE)]
        public const string FPS_MODE_DISABLED = "关闭";
        [TranslateMsg("FPS模式", VanillaStrings.CONTEXT_FPS_MODE)]
        public const string FPS_MODE_TOP_LEFT = "左上";
        [TranslateMsg("FPS模式", VanillaStrings.CONTEXT_FPS_MODE)]
        public const string FPS_MODE_TOP_RIGHT = "右上";
        [TranslateMsg("FPS模式", VanillaStrings.CONTEXT_FPS_MODE)]
        public const string FPS_MODE_BOTTOM_LEFT = "左下";
        [TranslateMsg("FPS模式", VanillaStrings.CONTEXT_FPS_MODE)]
        public const string FPS_MODE_BOTTOM_RIGHT = "右下";

        [TranslateMsg("选项，{0}为量")]
        public const string OPTION_PARTICLE_AMOUNT = "粒子数量：{0}";
        [TranslateMsg("选项，{0}为量")]
        public const string OPTION_SHAKE_AMOUNT = "屏幕震动：{0}";
        protected MainManager Main => MainManager.Instance;
        public bool NeedsReload { get; private set; }
        public bool BloodAndGore { get; private set; }
        public string Language { get; private set; }
        protected OptionsDialog dialog;
        private string[] languageValues = null!;
        private Vector2Int[] resolutionValues = null!;
    }
}
