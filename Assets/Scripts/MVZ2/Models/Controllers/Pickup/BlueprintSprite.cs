#nullable enable // autogenerated

using MVZ2.UI;
using TMPro;
using UnityEngine;

namespace MVZ2.Models
{
    public class BlueprintSprite : MonoBehaviour
    {
        public void UpdateView(BlueprintViewData viewData)
        {
            costText.text = viewData.cost;
            triggerCostRoot.SetActive(viewData.triggerActive);

            // Styles
            if (standaloneBackground) standaloneBackground.sprite = viewData.standaloneBackground;
            if (mobileBackground) mobileBackground.sprite = viewData.mobileBackground;
            if (mobileFrameTop) mobileFrameTop.sprite = viewData.mobileFrameTop;
            if (mobileFrameBottom) mobileFrameBottom.sprite = viewData.mobileFrameBottom;

            var icon = viewData.icon;
            iconRenderer.enabled = icon && !viewData.iconGrayscale;
            iconRenderer.sprite = icon;
            iconCommandBlockRenderer.enabled = icon && viewData.iconGrayscale;
            iconCommandBlockRenderer.sprite = icon;
            UpdateIcon();
        }
        protected void UpdateIcon()
        {
            var iconSprite = iconRenderer.sprite;
            if (!iconSprite)
                return;
            var spriteScale = new Vector2(iconSprite.rect.width / iconSpriteSize.x, iconSprite.rect.height / iconSpriteSize.y);
            Vector3 iconScale;
            if (lockAspect)
            {
                var maxScale = Mathf.Max(spriteScale.x, spriteScale.y);
                iconScale = Vector3.one * (1 / maxScale);
            }
            else
            {
                iconScale = new Vector3(1 / spriteScale.x, 1 / spriteScale.y);
            }
            iconRoot.localScale = iconScale;
        }
        [SerializeField]
        protected Transform iconRoot = null!;
        [SerializeField]
        protected SpriteRenderer iconRenderer = null!;
        [SerializeField]
        protected SpriteRenderer iconCommandBlockRenderer = null!;
        [SerializeField]
        protected GameObject triggerCostRoot = null!;
        [SerializeField]
        protected TextMeshPro costText = null!;

        [SerializeField]
        protected Vector2 iconSpriteSize;

        [Header("Styles (Standalone)")]
        [SerializeField]
        private SpriteRenderer standaloneBackground = null!;

        [Header("Styles (Mobile)")]
        [SerializeField]
        private SpriteRenderer mobileBackground = null!;
        [SerializeField]
        private SpriteRenderer mobileFrameTop = null!;
        [SerializeField]
        private SpriteRenderer mobileFrameBottom = null!;

        [SerializeField]
        protected bool lockAspect;
    }
}
